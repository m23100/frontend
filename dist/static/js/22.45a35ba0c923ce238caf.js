webpackJsonp([22],{"b/qP":function(e,a,t){var r=t("w6Zt");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t("rjj0")("79068b65",r,!1,{})},jo9h:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("m4jk"),n=t("wEYB"),i={data:function(){return{options2:[],value:[],input:"",props:{value:"label",children:"cities"},province_id:0,city_id:0,avatar:"",avatar_url:"",city_name:[],uploadUrl:n.a+"/api/image/imageUpload?type=user",uploadHeaders:{Authorization:"Bearer "+localStorage.getItem("token")},ruleForm:{name:"",signature:"",qq:"",city:[]},rules:{name:[{required:!0,message:"请输入昵称",trigger:"blur"},{max:20,message:"昵称不得超过20个字符",trigger:"blur"}],signature:[{required:!0,message:"请输入签名",trigger:"blur"},{max:50,message:"签名不得超过50个字符",trigger:"blur"}],qq:[{required:!0,message:"请输入QQ",trigger:"blur"},{max:15,message:"QQ不得超过15个字符",trigger:"blur"}]}}},inject:["reload"],methods:{handleItemChange:function(e){var a=this;this.options2.forEach(function(t,n){t.label==e[0]&&r.a.getCity({province_id:t.value}).then(function(e){e.data.forEach(function(e){a.options2[n].cities.push({label:e.name,value:e.id})})})})},handleChange:function(e,a){var t=this;this.options2.forEach(function(a,r){a.label==e[0]&&(t.province_id=a.value,a.cities.forEach(function(a,r){a.label==e[1]&&(t.city_id=a.value)}))})},submitForm:function(e){var a=this;this.$refs[e].validate(function(e){if(a.city_id<1||a.province_id<1)return a.$refs.ruleForm.fields[2].error="请选择城市",!1;if(!e)return!1;if(a.city_id<1||a.province_id<1)return a.$refs.ruleForm.fields[2].error="请选择城市",!1;var t={name:a.ruleForm.name,signature:a.ruleForm.signature,province_id:a.province_id,city_id:a.city_id,qq:a.ruleForm.qq,avatar:a.avatar};r.a.userEditInfo(t).then(function(e){0==e.code?(a.$message.success("提交成功!"),a.reload()):a.$message.error("提交失败")})})},resetForm:function(e){this.$refs[e].resetFields()},handleAvatarSuccess:function(e,a){this.avatar=n.b+e.data.url},beforeAvatarUpload:function(e){var a="image/jpeg"===e.type||"image/png"===e.type,t=e.size/1024/1024<2;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过 2MB!"),a&&t}},created:function(){var e=this;r.a.getProvince().then(function(a){a.data.forEach(function(a){e.options2.push({label:a.name,cities:[],value:a.id})})}),r.a.getUserInfo().then(function(a){e.ruleForm.name=a.data.name,e.ruleForm.signature=a.data.signature,e.province_id=a.data.province_id,e.city_id=a.data.city_id,e.ruleForm.qq=a.data.qq,e.avatar=a.data.avatar,e.avatar_url=n.b+a.data.avatar,e.city_name=[a.data.province.name,a.data.city.name],e.city_id>0&&e.options2.forEach(function(a,t){a.value==e.province_id&&r.a.getCity({province_id:a.value}).then(function(a){a.data.forEach(function(a){e.options2[t].cities.push({label:a.name,value:a.id})})})})}),this.city_id>0&&this.options2.forEach(function(a,t){a.value==e.province_id&&r.a.getCity({province_id:a.value}).then(function(a){a.data.forEach(function(a){e.options2[t].cities.push({label:a.name,value:a.id})})})})}},o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"Personal"},[t("div",{staticClass:"archives"},[t("h2",{staticClass:"Title"},[e._v("头像")]),e._v(" "),t("div",{staticClass:"Photo"},[t("el-upload",{staticClass:"avatar-uploader",attrs:{headers:e.uploadHeaders,action:e.uploadUrl,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.avatar?t("img",{staticClass:"avatar",attrs:{src:e.avatar}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)]),e._v(" "),t("div",{staticClass:"centent"},[t("h2",{staticClass:"Title"},[e._v("基本资料")]),e._v(" "),t("div",{staticClass:"PersonalData"},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"110px"}},[t("el-form-item",{attrs:{label:"昵称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入昵称"},model:{value:e.ruleForm.name,callback:function(a){e.$set(e.ruleForm,"name",a)},expression:"ruleForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"签名",prop:"signature"}},[t("el-input",{attrs:{placeholder:"请输入签名"},model:{value:e.ruleForm.signature,callback:function(a){e.$set(e.ruleForm,"signature",a)},expression:"ruleForm.signature"}})],1),e._v(" "),t("el-form-item",{staticClass:"is-required",attrs:{label:"城市",prop:"options2"}},[t("el-cascader",{attrs:{options:e.options2,props:e.props,value:e.value},on:{"active-item-change":e.handleItemChange,change:e.handleChange},model:{value:e.city_name,callback:function(a){e.city_name=a},expression:"city_name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"QQ",prop:"qq"}},[t("el-input",{attrs:{placeholder:"请输入对外公开的联系QQ"},model:{value:e.ruleForm.qq,callback:function(a){e.$set(e.ruleForm,"qq",a)},expression:"ruleForm.qq"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(a){e.submitForm("ruleForm")}}},[e._v("保存")]),e._v(" "),t("el-button",{on:{click:function(a){e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)])])};o._withStripped=!0;var l={render:o,staticRenderFns:[]},s=l;var c=!1;var u=t("VU/8")(i,s,!1,function(e){c||t("b/qP")},"data-v-2487987a",null);u.options.__file="src/views/Personal.vue";a.default=u.exports},w6Zt:function(e,a,t){(e.exports=t("FZ+f")(!1)).push([e.i,"\n.Title[data-v-2487987a] {\n  font-size: 18px;\n  color: #000;\n  border-left: 4px solid #43b5f9;\n  line-height: 22px;\n  padding-left: 10px;\n  font-weight: 400;\n  margin-bottom: 25px;\n}\n.Photo[data-v-2487987a] {\n  margin-left: 60px;\n  height: 174px;\n  position: relative;\n}\n/* lk */\n.centent[data-v-2487987a] {\n  background-color: #fff;\n  padding: 20px 12px;\n  height: 330px;\n  border-top: 1px solid #eee;\n}\n.el-input[data-v-2487987a]{\n  background-color: #f0f0f0;\n  border-radius: 4px;\n}\n.archives[data-v-2487987a]{\n  background-color: #fff;\n}\n.Personalspan[data-v-2487987a]{\n  width:50px;\n  font-size: 14px;\n  line-height: 36px;\n  color: #989898;\n}\n.Personalright[data-v-2487987a]{\n  width:  100%\n}\n.el-input__inner[data-v-2487987a]{\n  height: 35px;\n  line-height: 35px;\n  background-color: #f0f0f0;\n  border-radius: 4px;\n}\n.avatar-uploader .el-upload[data-v-2487987a] {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n.avatar-uploader .el-upload[data-v-2487987a]:hover {\n    border-color: #409EFF;\n}\n.avatar-uploader-icon[data-v-2487987a] {\n    font-size: 28px;\n    color: #8c939d;\n    width: 178px;\n    height: 178px;\n    line-height: 178px;\n    text-align: center;\n}\n.avatar[data-v-2487987a] {\n    width: 160px;\n    height: 160px;\n    display: block;\n}\n",""])}});